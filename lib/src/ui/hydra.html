<!DOCTYPE html>

<polymer-element name="hydra-app">
  <link rel="import" href="../modes/v8/ui/descriptions.html">
  <link rel="import" href="dropdown-element.html">
  <link rel="import" href="deopt-links.html">
  <link rel="import" href="graph-pane.html">
  <link rel="import" href="ir-pane.html">
  <link rel="import" href="method-list.html">
  <link rel="import" href="open-file-button.html">
  <link rel="import" href="source-pane.html">
  <link rel="import" href="source-path.html">
  <link rel="import" href="spinner-element.html">
  <link rel="import" href="tab-pane.html">
  <template>
    <style>
      #sidebar {
        position: fixed;
        top: 0px;
        left: 0px;
        bottom: 0px;
        width: 250px;
        background: #2C3E50;

        display: flex;
        flex-flow: column;
        flex-direction: column;
        padding: 5px;
      }

      #sidebar button {
        background: #2C3E50;
        border: 0px;
        color: white;
        width: 40px;
        height: 40px;
        font-size: 16pt;
      }

      #sidebar button:hover {
        background: #34495E;
      }

      #header {
        min-height: 40px;
        padding: 0px;
      }

      #pane {
        margin-left: 250px;
        padding: 0px;
      }

      method-list {
        display: flex;
        flex-flow: column;
        flex-direction: column;
        min-height: 0px;
      }
    </style>

    <div id="sidebar">
      <div id="header">
        <open-file-button on-opened="{{openCompilation}}" data-title="Load Compilation Artifacts"><i class="fa fa-folder-open"></i></open-file-button>
        <template if="{{currentFiles != null}}">
          <button href="#" on-click="{{reloadCurrentFiles}}" title="Reload Current Files"><i class="fa fa-repeat"></i></button>
        </template>
        <!-- TODO(mraleph): enable profiles back.
        <template if="{{currentMode != null}}">
          <open-file-button><i class="fa fa-bolt"></i></open-file-button>
        </template>
        -->
        <spinner-element id="spinner"></spinner-element>
      </div>

      <method-list methods="{{currentMethods}}" on-selected="{{displayPhase}}"></method-list>
    </div>

    <div id="pane">
      <template if="{{ir != null}}">
        <tab-pane disabled="{{ { 'source': currentMethod.sources.isEmpty  } }}">
          <div data-title="IR" data-href="ir">
            <ir-pane id="ir-pane" ir="{{ir}}" codeMode="{{codeMode}}"></ir-pane>
          </div>
          <div data-title="Graph" data-href="graph">
            <graph-pane ir="{{ir}}" on-block-mouse-over="{{showBlockAction}}" on-block-mouse-out="{{hideBlockAction}}">
            </graph-pane>
          </div>
          <div data-title="Source" data-href="source">
              <source-pane id="source-pane" path="{{sourcePath}}" on-deopt-enter="{{enterDeoptAction}}" on-deopt-leave="{{leaveDeoptAction}}">
              </source-pane>
          </div>
          <span class="after-tabs" data-when="ir">
            <template if="{{!ir.code.isEmpty}}">
              <dropdown-element value="{{codeMode}}">
                <li><a href="#" data-value="split">Split Disassembly</a></li>
                <li><a href="#" data-value="inline">Inline Disassembly</a></li>
                <li><a href="#" data-value="none">Hide Disassembly</a></li>
              </dropdown-element>
            </template>
          </span>
          <span class="after-tabs" data-when="ir|source">
            <deopt-links deopts="{{currentMethod.deopts}}" on-deopt-click="{{navigateToDeoptAction}}" on-deopt-enter="{{enterDeoptAction}}" on-deopt-leave="{{leaveDeoptAction}}">
            </deopt-links>
          </span>
          <span class="after-tabs" data-when="source">
            <source-path path="{{sourcePath}}">
            </source-path>
          </span>
        </tab-pane>
      </template>
    </div>
  </template>
  <script src="hydra.dart" type="application/dart"></script>
</polymer-element>